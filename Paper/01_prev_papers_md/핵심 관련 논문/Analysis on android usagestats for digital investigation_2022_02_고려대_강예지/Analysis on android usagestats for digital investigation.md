# @commons

# -.

ート，，，，

####

![](images/dd7c0e5abcd58aa46278f90aa1ec1f48688cb0ba444221196da09bdc10c6a785.jpg)

』#

Disclaimer

AS J U Analysis on Android Usagestats for Digital Investigation REA ITIA   
E UNIVERSITY   
B by 1005 Kang Ye Ji Department of Information Security   
School of Cybersecurity   
Korea University   
February，2022

#

# Analysis on Android Usagestats for Digital Investigation

#

20222

# 碩士學位論文

# Analysis on Android Usagestats for Digital Investigation

# 高麗大學校 情報保護大學院

情報保護學科

姜藝智

# 2022年2月

# 李相珍敎授指導碩士學位論文

# Analysis on Android Usagestats for Digital Investigation

o} 論文 工學 碩士學位 論文 提出.

# 2022年2月

# 高麗大學校 情報保護大學院

情報保護學科

姜藝智 (印)

# 2022年2月

委員長 印）委員 (印)委員 （印）

# Abstract

System logs on smartphone are created whenever an operating system or user event occurs， which can be of particular interest in forensic investigationsasotherlogsonsmartphonearesubjecttouser interference via modification or direct deletion of records. UsageStats is onetype ofsystem logthat recordsuser behaviours， events， and timestamps for each application which，while useful to identify user type or interest， is currently not leveraged for digital forensics. Some studies and tools exist to parse UsageStats，but the output of these tools is not useful for any meaningful investigation.

In this paper，we analyse the structure of UsageStats from a forensic perspective， and propose a method to utilise UsageStats for forensic investigation examined in a scenario-based case study. And we propose the visualisation method for each field of UsageStats.

keyword : Mobile Forensics, Usagestats,Digital Forensics

# Table of Contents

# 1. Introduction

# 2.Related Works 3

2.1. Android Log Analysis   
2.2. Usagestats ...

# 3. UsageStats.. 5

3.1. Acquisition .. 5   
3.2.Android 5.0 \~ Android 9 (API Level 21\~28) 5   
3.3.Android 10 （API Level 29）   
3.4.Android 11\~ Android 12（API Level $3 0 ^ { \sim } 3 1$ ） ·9   
3.5. Comparison by versions · 11

# 4.Implementation 15

4.1. Algorithm... …15   
4.2. Visualisation …17

# 5. Case Study . .22

5.1. Scenario.. 22   
5.2. Purpose and target 23   
5.3. Investigation with UsageStats 23   
5.3.1. User and Device Information 23   
5.3.2. Screen time ·24   
5.3.3. Camera and Telegram... 25

# 5.4. Result ……. … 26

6. Conclusion .. .-27

7. 号 .28

# List of Tables

Table 1. Android 9 and earlier versions - Data   
Table 2. Android 10 UsageStats - Data 9   
Table 3. Android 1l and later versions - Data · 11   
Table 4. User behaviour for types 13   
Table 5. Comparison of UsageStats by version …14   
Table 6. Scenario \* .22   
Table 7. Device information : ·23   
Table 8. Device and user information …24

# List of Figures

Figure 1. Android 9 and earlier versions - Directory structure.….6   
Figure 2. Android 10 UsageStats - Directory structure “ .8   
Figure 3. Android 11 and later versions - Directory : …10   
Figure 4. Usagestats analysis algorithm... 16   
Figure 5. UsageStats <packages>.. ….19   
Figure 6. UsageStats <configuration>... …20   
Figure 7. UsageStats <event-log> …21   
Figure 8. Sreen · ….24   
Figure 9. Camera and Telegram …25

# 1. Introduction

Mobile forensicsisto conductdigital forensic investigationon smartphones， tablet PCs，and wearable devices. The mobile device shows the user's life pattern and records the user's information. For example,a web browser installed on the mobile device could record usage of Internet,a messenger and SNS could record a contact，and a map could record a location where the user physically moved. The information recorded on mobile devices can be used for digital forensic investigation. Asthe use of smartphone has increased since the late 200Os，many studies on mobile forensics have been still in progress [1].

Meanwhile， the most used mobile operating system is Android. As of the time of writing this paper (November 2021)，Android's market share is $7 2 . 4 4 \%$ ，takingthe overwhelmingfirst place in mobile operating systems [2]. For this reason， there are many studies analysing the artifacts of applications running on Android [3],[4], [5]. In addition，since sensitivepersonalinformationisrecordedonmobiledevices, manufacturers applysecurity measures， such as encryption， to protect personal information. Security measures applied to mobile devices make mobile forensic investigation difficult， and there are studieson data acquisition from mobile devices [6]，[7]. Assuch，in mobile forensic research， there are forensic procedures and technical methods for data collection， and methods of investigating artifactsin mobile operating systemsandapplications. Weproposesamethodforusingand investigating UsageStats， an artifact that is basically created in the Android operating system， from a digital forensic point of view.

UsageStats is one of the system logs. The system log is a log generated by the operating system regardless of the user's intention.

Since the log is mainly recorded when an event occurs in the operating system， the system log is recorded extensively. In addition，it can be usefullyleveragedinforensicinvestigationsbecause thereislittle possibility that the user directly deletes or modifies it [8]. UsageStats records user actions (screen usage,focus,etc.)，events，and time for each package， and can beused tograsp user behaviours. Withthese characteristics, UsageStats is mainly used in applications to analyse types and interests of users [9]. Although UsageStats could be useful in digital forensicinvestigations， itisnotwidelyusedindigitalforensic investigations. This is because the structure is different for each Android version,and no research has been done on how to use UsageStats during forensic investigations.

There are a few tools to parse UsageStats [10],[11]. However, research on interpreting the meaning of each event has not been conducted, so the results of the tool simply list the event occurrence time and contents. For thisreason，even if the inspector checksthe resultsofanalysing UsageStats， there is a possibility that they cannot interpret or interpret them incorrectly.

In this paper， we study UsageStats collected from various versions of Android. In Section 2， we introduce research related to Android system logs and UsageStats， and in Section 3 we organise the structure of UsageStats by version，and look at the differences between versions from a forensic point of view. Section 4 introduces the visualisation and analysis method of UsageStats,and Section 5 proposes a method of using UsageStats for forensic investigation through a scenario-based case study. Finally,a conclusion is drawn in Section 6.

# 2.Related Works

# 2.1. Android Log Analysis

Research on Android logs is still ongoing. D. Kim et al. 2016 [1] conducted a study on mobile forensic trends and summarised Android OS and iOS mobile forensic procedures，data collection，and analysis. J. Cho et al.2017 [9] analysed system logs on Android OS-based smartphones and classified logs by item. S. Park et al. 2018 [12] conducted a study to detect abnormal behaviour by analysingsystemsand user logson Android OS-based devices and developing automated models. E. Park et al. 2020 [8] confirmed the system log that can be analysed according to the data acquisition method for the latest Samsung smartphone based on Android OS and proposed a forensic utilisation technique.

# 2.2. Usagestats

UsageStats of Android OS is a feature added in Android 5.0 version (API level 21） in October 2014， which includes statistics on each application usage and time by behaviour [8]. Android Open Source Project (AOSP） providesinformationrelatedtoUsageStatsManagerand UsageStats in documents and codes so that these UsageStats can be used forapplication development.[13],[14],[15]. You can create an application that tracks smartphone usage with the published UsageStats API [16][17], or create an application that detects vulnerabilities by tracking the status of your smartphone [18].

There are also studies that use or analyse UsageStats from a digital forensics perspective. Y. Konduru et al. 2018 [19] studied artifactson some famous applications on Android smartphones and used UsageStats to confirm their use. H. Pietresse 2018 [20l proposed a method of confirming the authenticity of data through confirmation of the time value of UsageStats. However， none of them introduced the exact structure or specific application method of UsageStats.

The UsageStats analysis tool includes XML Parser [21] developed by A.Brignoni for Android 9 and below versions，and Python Code for analysing and parsing the structure of UsageStats developed by Y. Khatri for Android 10 versions [22]. However， the method introduced in this study cannot be applied because the structure of UsageStats has changed inthe latest Android versions of 11 or higher. The most recently published UsageStats study mentions Android 11，but only methods of identifying Android versions have been studied [23],and the structure of the changed UsageStats has not been analysed. ALEAPP [10 is an Android log event and protocol buffer parser disclosed as an open source. The latest Android version of UsageStats has also been added, but only parsing has been supported and interpretation of the content has not been studied.

Existing studies are meaningful in that they suggest ways to use system logs for digital forensics in Android OS-based smartphones or support UsageStats parsing. However， since the data stored in UsageStats has not been studied in detail,analysis of UsageStats is required from a forensic point of view. Therefore， this paper analyses the UsageStats structure and stored data in all Android versions， including the latest Android 12 version，presents visualisation plans and forensics,and shows the possibility of practical use through scenario-based experiments.

# 3. UsageStats

In this section， we introduce a method of acquiring UsageStats,and analyse the structure and information stored for each version.

# 3.1. Acquisition

Android system log without root permissions,user data are stored in the partition and there is no access. Therefore，the routing (rooting） and full filesystem system logs can be achieved through the collection. Gather in the same way as one of the system log also usagestats. The path by Android version different, and equal to Table 5.

# 3.2.Android 5.0 \~ Android 9 (API Level 21\~28)

UsageStats is thefeature first added in Android 5.O version (API level 21)，and stores user statistics for each application package along with time. In Android version 5-9， the storage path of UsageStatsis '/data/system/usagestats/ $0 / \prime$ ，and the directory structure isshownin [Figure 1]. UsageStatsarestored in four directoriesdaily， weekly, monthly，and yearly according to the storage cycle.

Under the four directories (daily，weekly，monthly，yearly)，there are UsageStats files created at various time intervals. The name of the file is atimestamprepresentedbyUnixMillseconds(UTC). Thetime information in each file is calculated based on the timestamp in each filename.

Theversion(/data/system/usagestats/0/version） filecontainsthe

UsageStatsversion， Androidversion， codename， Personal DigitalAssistant (PDA)/Count Specific Code (CSC） build version， CSC. Eachfield issectionalised bysemicolon(';'） exceptAndroidversionandUsageStats version by a new-line character $\mathrm { { ( 0 x 0 A ) } }$ ：

![](images/8651295858b56f476caf164dac5c0cc6e3b12fa084696ca2abd787dc81b2a0db.jpg)  
Figure 1. Android 9 and earlier versions - Directory structure

In Android version 9 and below,UsageStats information is stored in the form of an eXtensible Markup Language (XML). Information stored in UsageStats is divided into three categories; <packages>，<configuration>, and<event-log>. Applicationusageisrecordedin<packages>. Configuration values ，such as the time a device is powered on/off, screen size，etc.，are recorded in <configuration>. And in <event-log>，user behaviour and execution of the application are recorded in detail. The main information that can be found in each field is shown in Table 1.

Table 1. Android 9 and earlier versions - Data   

<table><tr><td>Field</td><td>Attribute</td><td>Description</td><td>Example</td></tr><tr><td rowspan="5">packages</td><td>package</td><td>package name</td><td>com.kakao.talk</td></tr><tr><td>lastTimeActive</td><td>last executed time</td><td>85346646</td></tr><tr><td>timeActive</td><td>total executed time</td><td>656029</td></tr><tr><td>lastEvent</td><td>last recorded event</td><td>2</td></tr><tr><td>appLaunchCount</td><td>total app lunch count</td><td>13</td></tr><tr><td rowspan="2">configuratio ns</td><td>lastTimeActive</td><td>last used time</td><td>29129150</td></tr><tr><td>timeActive</td><td>totle used time</td><td>15630608</td></tr><tr><td rowspan="4">event-log</td><td>package</td><td>package name</td><td>com.googleadroid.youtu</td></tr><tr><td>class</td><td>class name</td><td>com.google.android.apps. youtube.app.watchwhile. WatchWhileActivity</td></tr><tr><td>time</td><td>event occurrencetime</td><td>49848</td></tr><tr><td>type</td><td>behaviour type</td><td>1</td></tr></table>

# 3.3.Android 10 (API Level 29)

In Android version 10 (API level 29)，UsageStats has been partially changed. First,as the system-as-root was forced from Android 10 and above， the storage was divided into two categories: Device Encrypted (DE） storage and Credential Encrypted (CE） storage. The DE storage stores data such as wallpaper and alarm that can be checked even when the device is locked. Personal data such as contact information， photos, logs，etc.，which can only be checked when the device is unlocked, are stored in the CE storage. UsageStats is stored in CE storage because it isa kind of personal data， and thus UsageStats is stored in the '/data/system_ce/usagestats/ $0 ^ { \prime }$ pathinAndroid 10.Thedirectory structure， information on the version file,and the UsageStats file name are recorded in the same format as Android 9 and lower versions，as shown in Figure 2.

![](images/8b638e4c03f422405ec0d862ff567defc5c0fc7c0bfcf17c1e8ead875c75df3f.jpg)  
Figure 2. Android 10 UsageStats - Directory structure

Up to Android 9， UsageStats is easily parsed as it has an XML structure. However， UsageStats in Android 10 is in binary format and uses a protocol buffer. The protocol buffer here is usagestatservice.proto [24]，which can be found in Android Open Source Project (AOSP)．A protocol buffer file can be converted into a Python file using a tool such asprotoc[25]， throughwhichthestructureincludedinthe usagestatservice.proto in the source code can be retrieved to develop a parser [22].

The information stored in each section ( $\textless$ packages>，<configuration>, and <event-log>） is similar to Android 9,but some has been changed. First,instead of recording the package name for each log，it records strings at the front of the UsageStats file. Also,in the log，the package list is indexed by'package_index'. 'lastEvent'is no longer used,and 'last_time_visible_ms'and'total_time_visible_ms'are added to record the time that the application had been executed in the foreground. The main information that can be found in each field is shown in Table 2.

Table 2. Android 10 UsageStats - Data   

<table><tr><td>Field</td><td>Attribute</td><td>Description</td><td>Example</td></tr><tr><td colspan="2">package</td><td>package name</td><td>com.android.vending</td></tr><tr><td rowspan="6">packages</td><td>package_index</td><td>package index</td><td>53</td></tr><tr><td>last_time_active_ms</td><td>last executed time</td><td>5570193</td></tr><tr><td>total_time_active_ms</td><td>total executed time</td><td>16240</td></tr><tr><td>last_time_visible_ms</td><td>last visible time</td><td>5570218</td></tr><tr><td>total_time_visible_ms</td><td>total visible time</td><td>16752</td></tr><tr><td>appLaunchCount</td><td>total app launch count</td><td>2</td></tr><tr><td rowspan="2">configuration s</td><td>last_time_active_ms</td><td>last used time</td><td>604523249</td></tr><tr><td>total_time_active_ms</td><td>total used time</td><td>53392</td></tr><tr><td rowspan="5">event-log</td><td>package_index</td><td>packge index</td><td>53</td></tr><tr><td>class_index</td><td>class index</td><td>13</td></tr><tr><td>time_ms</td><td>event occurrence time</td><td>5538230</td></tr><tr><td>type</td><td>behaviour type</td><td>15</td></tr><tr><td></td><td></td><td></td></tr></table>

# 3.4.Android 11\~ Android 12 (API Level 30\~31)

From Android 11， mapping and migrated files in the UsageStats directory are added, and the structure of the UsageStats file has been partiallychanged.Thein-devicestoragepathis '/data/system_ce/usagestats/ $' 0 ^ { \prime }$ ， and the changed directory structure is shown in Figure 3. The structure of the 'version' file and the UsageStats file name is the same as Android 1O and lower versions.

'migrated'file(/data/system_ce/usagestats/0/migrated)contains a previous UsageStats version and from this version we can infer a previous Android version on the device. If the version checked within the 'version' file is 5 and the version checked in the 'migrated' file is 4, you can find out that the device has been updated from Android 10 to 11.

'mapping'file(/data/system_ce/usagestats/0/mapping）createdfor structural obfuscation. contains all information which is in string format; packagenames， classnames， andadditionalinformationusedby UsageStats. Package names that were stored asstrings within the UsageStats binary file disappear. But are stored using tokens instead. Therefore, the package name is found in mapping using the token of UsageStats.

![](images/fd14a6b54c4c65703ac5869b10ee5d2e193ca20015b933cf92e3c90c83d9139c.jpg)  
Figure 3. Android 11 and later versions - Directory

UsageStats on Android 11 isstored in a binaryprotocol buffer structure like Android 10, but the structure has been partially changed. It can be analysed as in Android 1O using the usagestatsservice_v2.proto [26] file in the Android source code.'mapping' file is also in the form of a protocol buffer and can be analysed using the Obfused PackagesProto in usagestatsservice_v2.proto.

<packages>，<configuration>，and <event-log> The information stored in each item is the same as Android 10,except that the package name is stored as a token. Package_index and class_index were changed to package_token and class_token， respectively. The main information that can be found in each field is shown in Table 3.

Table 3. Android 11 and later versions - Data   

<table><tr><td>Field</td><td>Attribute</td><td>Description</td><td>Example</td></tr><tr><td rowspan="6">packages</td><td>package_token</td><td>packge token</td><td>422</td></tr><tr><td>last_time_active_ms</td><td>last executed time</td><td>1635815825516</td></tr><tr><td>total_time_active_ms</td><td>total executed time</td><td>131425</td></tr><tr><td>last_time_visible_ms</td><td>last visible time</td><td>1635815825516</td></tr><tr><td>total_time_visible_ms</td><td>total visible time</td><td>3499</td></tr><tr><td>appLaunchCount</td><td>total app lunch count</td><td>2</td></tr><tr><td rowspan="2">configurations</td><td>last_time_active_ms</td><td>last used time</td><td>1635813998574</td></tr><tr><td>total_time_active_ms</td><td>total used time</td><td>28980</td></tr><tr><td rowspan="4">event-log</td><td>package_token</td><td>packet token</td><td>422</td></tr><tr><td>class_token</td><td>class token</td><td>1</td></tr><tr><td>time_ms</td><td>event occurrence time</td><td>1634917474613</td></tr><tr><td>type</td><td>behaviour type</td><td>17</td></tr></table>

# 3.5.Comparison by versions

Table 4 shows the types of actions that we can find in 'event-log' for each version. We can determine what kind of behaviour hasbeen performed for each recorded event.

Table 5 summarises the results of analysing UsageStats by Android version. UsageStats are stored in different formats depending on the Androidversiosoerathsvaryreforeitis analyse and parse properly according to each version.

Table 4. User behaviour for types   

<table><tr><td>No ·</td><td>Type</td><td>Description</td></tr><tr><td>0</td><td>NONE</td><td>No event type.</td></tr><tr><td>1</td><td>ACTIVITY_RESUMED</td><td>AneventtypedetingnActivityedt</td></tr><tr><td>2</td><td>ACTIVITY_PAUSED</td><td>An event type denoting that an Activity moved to the background.</td></tr><tr><td>5</td><td>CONFIGURATION_CHANGE</td><td>An event tigur denting than the device</td></tr><tr><td>7</td><td>USER_INTERACTION</td><td>An event type denoting that a package was interacted with in some way by the user.</td></tr><tr><td>8</td><td>SHORTCUT_INVOCATION</td><td>An event type denoting that an action equivalent to a ShortcutInfo is taken by the user.</td></tr><tr><td>11</td><td>STANDBY_BUCKET_CHANGE</td><td>An eventtypedenotigachangeinAppStandby</td></tr><tr><td>15</td><td>SCREEN_INTERACTIVE</td><td>An event type denoting that the screen has gone in to an interactive state (turned on for full user interaction，not ambient display or other non-interactive state).</td></tr><tr><td>16</td><td>SCREEN_NON_INTERACTIVE</td><td>An event type denoting that the screen has gone in to a non-interactive state (completely turned off or turned on only in a non-interactive state like ambient display).</td></tr><tr><td>17</td><td>KEYGUARD_SHOWN</td><td>An event type denoting that the screen&#x27;s keyguard has been shown，whether or not the screen is off.</td></tr><tr><td>18</td><td>KEYGUARD_HIDDEN</td><td>An eventyuadenatingthitheen&#x27;s</td></tr><tr><td>19</td><td>FOREGROUND.SERVICE_STA</td><td>An event type denotingstartofaforeground</td></tr><tr><td>20</td><td>FOREGROUND_SERVICE_STO</td><td>An event type denotingstopofaforeground An activity becomes invisible on the UI,</td></tr><tr><td>23</td><td>ACTIVITY_STOPPED</td><td>corresponding to Activity.onStop( of the activity&#x27;s lifecycle.</td></tr><tr><td>26</td><td>DEVICE_SHUTDOWN</td><td>AneventtdedeteAnddrutm</td></tr><tr><td>27</td><td>DEVICE_STARTUP</td><td>An event type denoting that the Android runtime started up.</td></tr></table>

Table 5. Comparison of UsageStats by version   

<table><tr><td></td><td>Android 5~9</td><td>Android 10</td><td>Android 11~12</td></tr><tr><td>Format</td><td>XML</td><td>Binary</td><td>Binary</td></tr><tr><td>Path</td><td>/data/system/usagest ats/0/</td><td>/data/system_ce/usag estats/0</td><td>/data/system_ce/usage stats/0</td></tr><tr><td>Directory name</td><td>daily，weekly, monthly，yearly</td><td>daily，weekly, monthly，yearly</td><td>daily，weekly, monthly，yearly</td></tr><tr><td>UsageStats Filename</td><td>Timestamp (Unix Milliseconds)</td><td>Timestamp (Unix Milliseconds)</td><td>Timestamp (Unix Milliseconds)</td></tr><tr><td>Files</td><td>version</td><td>version</td><td>mappinges, migrated.</td></tr><tr><td>UsageStats version</td><td>3</td><td>4</td><td>5</td></tr><tr><td>Protocol Buffer Type</td><td></td><td>usagestatsservice.pro to</td><td>usagestatsservice_v2.p roto</td></tr><tr><td>Featured Change</td><td></td><td>Protocol buffer</td><td>Tokenised package name</td></tr></table>

# 4.Implementation

# 4.1. Algorithm

UsageStats' analysis algorithm is shown in Figure 4. First, UsageStats folder in the Android image is added as input. Android and UsageStats versionsare checked through the internal 'version'file，and analysis modules are executed according to the version are executed. The data analysed in each version of the parser is in the form of csv and is input to the visualisation module,and the data is displayed in the form of a timeline.

# Usagestats

Usagestatsanalysis tool algorithm for digital forensic investigation

![](images/b72d187800060ee4b05c36083dbf1ae567a29ea2c7dd4069e63b1ebaa54ce3e4.jpg)

Figure 4. Usagestats analysis algorithm

# 4.2. Visualisation

Usagestats consists of 3 fields; <packages>， <configuration>， and <event-log>. Since the information stored in each field isdifferent, visualisation should be implemented in different ways.

First,<packages> stores information such as the time used for each package and class，and the time of last use. Therefore， the X-axis is composed of the time used and the timestamp， and the y-axisis composed of the application list. The horizontal bar graph represents total_time_active, total_time_service_used， total_time_visible used for each application，and basically sorts from above in the order of many running applications. Visual information(last_time_active, last_time_service_used, and last_time_visible） has the color of a bar graph associated with each information and is expressed as a dot.

In <configuration>，it can be seen that the setting value changes over time. Since it has values for each attribute，it is better to show the contents in a table. Therefore, the X-axis is set as the time axis,and the time when each log ecorded is indicated. It is easiest to understand when an attribute appears in a hovering table for time. However， this field is rarely used in forensic investigation except for 'locale'.

In <event-log>，actions performed for each package and class are stored together with the time value. Therefore, the X-axis is composed of time and the y-axis is composed of an application list. The upper part of the application list is a log whose package name is 'android'，that is,an actionthatisnotdependentononeapplication.Type15 (SCREEN_INTERACTIVE） and type 16(SCREEN_NON_INTERACTIVE) CH show the actual time of screen touch，and the execution period for each application starts with type 1 (ACTIVITY_RESUMED） and ends with

![](images/20606a1fd6f3380fa65435bb966d86d0cc5d8f8d1b9be8f038ce67ebf30ee51b.jpg)  
Figure 5. UsageStats (packages>

<table><tr><td>Last TimeActive</td><td colspan="3">2021-07-2215:38:49(302754960)</td></tr><tr><td>Time Active</td><td>5543</td><td>keyHid</td><td>1</td></tr><tr><td>count</td><td>2</td><td>hardKeyHid</td><td>2</td></tr><tr><td>fs</td><td>1065353216</td><td>nav</td><td>1</td></tr><tr><td>locale</td><td>ko-KR</td><td>navHid</td><td>2</td></tr><tr><td>touch</td><td>3</td><td>ori</td><td>1</td></tr><tr><td>key</td><td>1</td><td>scrLay</td><td>268435810</td></tr><tr><td>width</td><td>360</td><td>clrMod</td><td>5</td></tr><tr><td>height</td><td>668</td><td>SW</td><td>360</td></tr><tr><td>ui</td><td>17</td><td>density</td><td>480</td></tr></table>

Figure 6. UsageStats <configuration>

![](images/1a85c0f8bd2cfc87839facd6f904f215d6eba9ebeebabc4c820c19a74a96bd47.jpg)  
Figure 7. UsageStats <event-log>

# 5. Case Study

In this section，we conducted forensic investigations for a hypothetical crime scenario using UsageStats. It shows that the information stored in UsageStats can confirm the behaviour performed at a specific time.

# 5.1. Scenario

Company A is the No.1 battery (secondary battery） company in Korea. Batterytechnology is designated asa national core technology，and companies are also striving for security by attaching security stickers to devices and reconfirming them when they leave work to protect the core technology.

One day，a security officer noticed that the security sticker on Park's (a battery engineer of Company A） smartphone was damaged. So the smartphone was immediately confiscated. The seized smartphonewas delivered to the forensic investigation team. All messenger applications have been deleted and databases related to this case cannot be obtained. However， through photosfound on smartphonesand linksonthe clipboard, we found that photos that contains drawings of battery is sent through Telegram open chat room at a specific time.

Table 6. Scenario   

<table><tr><td>Timestamp</td><td>Behaviour</td></tr><tr><td>2021-12-09 15:12:23</td><td>Suspect took a photo using a camera app and sent the photo through Telegram</td></tr></table>

# 5.2. Purpose and target

The information on Android devices used in the experiment is shown in Table 7. We used Samsung smartphone with the latest version of Android 11. Bootloader unlocking and routing were performed to acquire data,and artifacts were collected in an active state using adb.

Table 7. Device information   

<table><tr><td>Model</td><td>Galaxy A30 (SM-A305N)</td></tr><tr><td>Android Version</td><td>Android 11</td></tr><tr><td>Kernal Version</td><td>4.4.177-21753844</td></tr></table>

# 5.3. Investigation with UsageStats

This subsection describes the analysis of evidence through information that can only be obtained using UsageStats. Park's smartphone,which is the subject of analysis，is the Samsung Galaxy A30 (SM-A305N） with Android OS 11 version.

# 5.3.1.User and Device Information

We can know the Android version， code name, PDA/CSC firmware build version,and carrier code from UsageStats''version'.In addition,the string stored in 'mapping' includes account information. Especially，‘com. android.gm’packagecontainsGmailaccountinformation， whichis basically linked to the account used in the Play Store, indicating that it is a Google account logged in to the device. Table 8 shows the information of the seized device.

Table 8. Device and user information   

<table><tr><td>Field</td><td>Value</td><td>Source</td></tr><tr><td>Android version</td><td>11</td><td rowspan="4">version</td></tr><tr><td>Codename</td><td>REL</td></tr><tr><td>Buildversion(PDA)</td><td>A305NKSU5CUF2</td></tr><tr><td>CSC</td><td>CSC</td></tr><tr><td>Buildversion(CSC)</td><td>A305NOKR5CUF2</td><td></td></tr><tr><td>User account</td><td>daeree.park@gmail.com</td><td>mappings</td></tr></table>

# 5.3.2. Screen time

In addition， the event log in which the package name is recorded as android records state change information of the device itself,which is not limited to one package，'SCREEN_INTERACTIVE $1 5 ^ { \prime }$ isan event in which the user starts using the screen,and 'SCREEN_INTERACTIVE $1 6 ^ { \prime }$ is an event in which the user ends using the screen (Table 4). Through these two event logs,the user can unlock the screen，actually use it， and know the time. Therefore，it can be seen that the device started to be used at ‘2021-12-09 15:12:11’ and the use ended at‘2021-12-09 15:12:36' (Figure 8).

Figure 8. Sreen   

<table><tr><td>Last Time Active 国</td><td>Usage Type</td><td>Package</td><td>Type 回</td><td>Class</td><td>source</td></tr><tr><td>2021-12-09 15:15:11</td><td>event-log</td><td>android</td><td>SCREEN_INTERACTIVE</td><td></td><td>dily</td></tr><tr><td>2021-12-09 15:15:12</td><td>event-Iog</td><td>com.sec.androidapp.cer</td><td>ACTIVITY_RESUMED</td><td>com.android.launcher3.Launcher</td><td>daily</td></tr><tr><td>2021-12-09 15:15:12</td><td>event-log</td><td>android</td><td>KEYGUARD_HIDDEN</td><td></td><td>dally</td></tr><tr><td>2021-12-09 15:15:18</td><td>event-log</td><td>com.sec.android.app.launcher</td><td>ACTIVITY_PAUSED</td><td>com.android.launcher3.Launcher</td><td>daily</td></tr><tr><td>2021-12-09 15:15:18</td><td>event-log</td><td>com.sec.android.gallery3d</td><td>ACTIVITY_RESUMED</td><td>comsi</td><td></td></tr><tr><td>2021-12-09 15:15:18</td><td>event-1og</td><td>com.sec.android.gallery3d</td><td>STANDBY_BUCKET_CHANGED</td><td></td><td>daily</td></tr><tr><td>2021-12-09 15:15:18</td><td>event-log</td><td>com.sec.android.app.launcher</td><td>ACTIVITY_STOPPED</td><td>com.android.launcher3.Launcher</td><td>daily</td></tr><tr><td>2021-12-09 15:15:23</td><td>event-log</td><td>com.sec.android.gallery3d</td><td>ACTIVITY_PAUSED</td><td>comsams</td><td></td></tr><tr><td>2021-12-09 15:15:23</td><td>event-1og</td><td>android</td><td>ACTIVITY_RESUMED</td><td>com.android.internal.app.ChooserActivity</td><td>daily</td></tr><tr><td>2021-12-09 15:15:23</td><td>event-Iog</td><td>com.google.android.gms</td><td></td><td></td><td>daily</td></tr><tr><td>2021-12-09 15:15:25</td><td>event-log</td><td>org.telegram.messenger</td><td></td><td></td><td>daily</td></tr><tr><td>2021-12-09 15:15:26</td><td>event-log</td><td>android</td><td>ACTIVITY_PAUSED</td><td>com.android.inernal.ap.ChooserActivity</td><td>daily</td></tr><tr><td>2021-12-09 15:15:26</td><td>event-log</td><td>org.telegram.messenger</td><td>ACTIVITY_RESUMED</td><td>org.telegram.uunchctiviy</td><td>dally</td></tr><tr><td>2021-12-09 15:15:27</td><td>event-Iog</td><td>com.sec.android.gallery3d</td><td>ACTIVITY_STOPPED</td><td>comsmsi</td><td></td></tr><tr><td>2021-12-09 15:15:27</td><td>event-log</td><td>android android</td><td>ACTIVITY_STOPPED</td><td>com.android.internal.app.ChooserActivity</td><td>daily</td></tr><tr><td>2021-12-09 15:15:37</td><td>event-log event-log</td><td></td><td>SCREEN_NON_INTERACTIVE ACTIVITY_PAUSED</td><td></td><td>daily</td></tr><tr><td>2021-12-09 15:15:37 2021-12-09 15:15:37</td><td>event-10g</td><td>org.telegram.messenger org.telegram.messenger</td><td>ACTIVITY_STOPPED</td><td>org.telegram.ui.LaunchActivity org.telegram.ui.LaunchActivity</td><td>daily</td></tr><tr><td>2021-12-09 15:15:38</td><td>event-log</td><td>android</td><td>KEYGUARD_SHOWN</td><td></td><td>daily daily</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td></tr></table>

# 5.3.3. Camera and Telegram

In the'event $- \mathrm { l o g } ^ { \prime }$ ，we can find information with package, class,and timestamp. Through this log，we can determine the user's behaviour at certain time. We should focus on 5 types to check application usage. 'ACTIVITY_RESUMED $( 1 ) ^ { \prime }$ is created when the app starts running while 'ACTIVITY_PAUSED $( 2 ) ^ { \prime }$ is created when the app is stopped. When the appisfinally terminated， 'ACTIVITY_STOPPED (23)'iscreated. In addition，inthecaseofseveralactivities，logsoftypes 'FOREGROUND_SERVICE_START (19)’ and 'FOREGROUND_SERVICE_STOP $( 2 0 ) ^ { \prime }$ are generated. (Table 4). Through these logs，you can accurately check the time when the app is running. The camera usage time is from ‘2021-12-09 15:12:17' to ‘2021-12-09 15:12:27',and it can be estimated that photographs were taken from “2021-12-09 15:12:22’ to 2021-12-09 15:12:24'.It can be seen that the time of use of the telegram is from '2021-12-09 15:12:27' to '2021-12-09 15:12:34' (Figure 9).

<table><tr><td></td><td>LastTime Active</td><td>国</td><td>Usage Type</td><td>Package</td><td>Type □</td><td>Class</td><td>Source</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:17</td><td></td><td>event-log</td><td>com.sec.android.app.camera</td><td>ACTIVITY_RESUMED</td><td>com.sec.android.app.camera.Camera</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:18</td><td></td><td>event-log</td><td>com.sec.android.app.launcher</td><td>ACTIVITY_STOPPED</td><td>com.android.launcher3.Launcher</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:18</td><td></td><td>event-log</td><td>com.sec.android.app.camera</td><td>ACTIVITY_PAUSED</td><td>com.sec.android.app.camera.Camera</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:18</td><td></td><td>event-log</td><td>com.sec.android.app.launcher</td><td>ACTIVITY_RESUMED</td><td>com.android.launcher3.Launcher</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:19</td><td></td><td>event-log</td><td>comsec.androidapp.a</td><td>ACTIVITY_STOPPED</td><td>com.sec.android.app.camera.Camera</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:20</td><td></td><td>event-Iog</td><td>com.sec.android.app.lncer</td><td>ACTIVITY_PAUSED</td><td>com.android.launcher3.Launcher</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:20</td><td></td><td>event-log</td><td>com.sec.android.app.camera</td><td>ACTIVITY_RESUMED</td><td>com.sec.android.app.camera.Camera</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:21</td><td></td><td>event-log</td><td>com.sec.android.app.launcher</td><td>ACTIVITY_STOPPED</td><td>com.android.launcher3.Launcher</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:22</td><td></td><td>event-log</td><td>com.sec.android.app.camera</td><td></td><td>FOREGROUN_SAcomsmsungadrodameracoe2.processor.Pr</td><td></td><td></td></tr><tr><td></td><td>2021-12-09 15:12:22</td><td></td><td>event-log</td><td>com.sec.android.app.camera</td><td></td><td></td><td>dally</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:23</td><td></td><td>event-log</td><td>com.sec.android.app.camera</td><td>ACTIVITY_PAUSED</td><td>com.sec.android.app.camera.Camera</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:23</td><td></td><td>event-1og</td><td>com.sec.android.app.launcher</td><td>ACTIVITY_RESUMED</td><td>com.android.launcher3.Launcher</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:23</td><td></td><td>event-1og</td><td>com.sec.android.ap.camea</td><td>ACTIVITY_STOPPED</td><td>com.sec.android.app.camera.Camera</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:24</td><td></td><td>event-log</td><td>com.sec.android.app.camera</td><td>FOREGROUND_SERVICE_STOP</td><td>com.samsung.android.camera.core2.processr.PostProdaily</td><td></td><td></td></tr><tr><td></td><td>2021-12-09 15:12:27</td><td></td><td>event-log</td><td>com.sec.android.app.launcher</td><td>ACTIVITY PAUSED</td><td>com.android.launcher3.Launcher</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:27</td><td></td><td>event-log</td><td>org.telegram.messenger</td><td>ACTIVITY_RESUMED</td><td>org.telegram.ui.LaunchActivity</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:27</td><td></td><td>event-log</td><td>com.sec.androidapauncher</td><td>ACTIVITY_STOPPED</td><td>com.android.launcher3.Launcher</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:34</td><td></td><td>event-log</td><td>org.telegram.messenger</td><td>ACTIVITY_PAUSED</td><td>org.telegram.ui.LaunchActivity</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:34</td><td></td><td>event-log</td><td>com.sec.android.app.launcher</td><td>ACTIVITY_RESUMED</td><td>com.android.launcher3.Launcher</td><td>daily</td><td></td></tr><tr><td></td><td>2021-12-09 15:12:34</td><td></td><td>event-log</td><td>org.telegram.messenger</td><td>ACTIVITY_STOPPED</td><td>org.telegram.ui.LaunchActivity</td><td>dally</td><td></td></tr><tr><td></td><td>2021-12-0915:12:36</td><td></td><td>event-log</td><td>android</td><td>SCREEN_NON_INTERACTIVE</td><td></td><td>daily</td><td></td></tr></table>

Figure 9. Camera and Telegram

# 5.4. Result

Through UsageStats analysis, Park's device usage time and behavior information can be identified. It can be seen that the device was being used at 3:12 p.m.on December 9,the time of the incident，and that cameras and Telegram applicationswere also being used. Telegram applications can be deleted,but UsageStats cannot as it is a system log. Therefore， since the user cannot delete it arbitrarily， the possibility of destroying evidence is low. In addition，even when the database is deleted， the event isrecorded with timestamp， so it ispossible to accurately check which application was executed at a specific time. Therefore, UsageStats can be used as‘gold' evidence for digital forensics.

# 6. Conclusion

This paper analyses the structure of UsageStats for each Android 5 to 9，10，and 11 to 12 versions and identifiesdifferencesby version. UsageStats in Android version 5 to 9 recorded logs in XML format, and logs in Protocol Buffer format in Android version 10 to 12. And we proposed method of analysing UsageStats recorded in protocol buffer. ThroughUsageStatsanalysis， itwasconfirmedthatmeaningful information about package execution， such asexecution time， event occurred, and package name， was recorded. Through a scenario-based case study，we demonstrated that UsageStats can be leveraged to grasp the user's behaviour even application artifacts had been deleted. However, UsageStats are vastly recorded so it takes a lot of time to manually analyse. Therefore， we presents visualisation method that allow forensic investigator to easily inspect the evidence in a short time. We expect that utilisation of UsageStats in this study will be useful in mobile forensics in the future,even with smartphone in Android 12 and later versions.

# 7.

.，，

，

UsageStats     ，，，UsageStats  ．UsageStats

UsageStats三11，12  UsageStats ．UsageStats   .，  UsageStats斗

# Bibliography

[1] D.H. Kim,and S. J. Lee. "Mobile Forensic Trend," Review of KIISC, 26.5,22-31，2016.   
[2] Android Usage Statistics, https://gs.statcounter.com/os-market-share/m obile/worldwide. Accessed Oct, 2021.   
[3] A.Menahil, W. Iqbal, M. Iftikhar， W. B. Shahid, K. Mansoor, S. Ruba b,"Forensic Analysis of Social Networking Applications on an Androi d Smartphone." Wireless Communications and Mobile Computing，Vol. 2021，2021.   
[4] A. AlZahrani, M. A. Wani,W. A. Bhat, "Forensic analysis of Twitch video streaming activities on Android." Journal of Forensic Sciences，V ol.66,No.5,pp.1721-1741,2021.   
[5] P. Domingues,R. Nogueira, J. C. Francisco， M. Frade, "Post-mortem d igital forensic artifacts of TikTok Android App." Proceedings of the 15 th International Conference on Availability，Reliability and Security，p p. 1-8,2020.   
[6] P. Feng,Q. Li, P. Zhang, Z. Chen, "Logical acquisition method based o n data migration for Android mobile devices." Digital Investigation， Vo 1. 26，pp.55-62，2018.   
[7] S.J. Yang, J. H. Choi, K. B. Kim, T. J. Chang, "New acquisition met hod based on firmware update protocols for Android smartphones." Di gital Investigation, Vol. 14, pp. S68-S76, 2015.   
[8] E. H. Park, S. J. Kang, S. R. Kim, J. S. Kim, "System Log Analysis a nd Forensic Application Techniques of Latest Samsung Smartphones b y Data Acquisition Methods," Journal of Digital Forensics， Vol. 14, No. 1,pp.1-19,2020. 2CH   
[9] J. H.Jo,J. H.Lee,S.R.Kim,J. H.Lee,S.J.Yang,CHLee, "Anal ysis on Non-Volatile System Log of Android Based Smartphone," Jour nal of Digital Forensics，Vol.11,No.2，pp.19-42,2017.   
[10] iLEAPP & ALEAPP: Parse and validate mobile forensic artifacts with Python， The Digital Forensic Research Conference DFRWS 2020 US A,2020.   
[11] Magnet AxiomProduct Documents，https://support.magnetforensic.c om/s/product-documentation?prod $\underline { { \underline { { \mathbf { \Pi } } } } }$ axiom-artifact，Accessed Oct， 2021.   
[12] S. J. Park, S. Y. Park, K. W. Ma,“An automatic user activity analys is method for discovering latent requirements: usability issue detectio n on mobile applications,” Sensors，vol. 18,no. 9,pp. 2963,2018.   
[13] UsageStats， https://developer.android.com/reference/android/app/usage/ UsageStats. Accessed Oct. 2021.   
[14] AOSP/platform_frameworks_base,https://github.com/aosp-mirror/platfo rm_frameworks_base/tree/master/services/usage/java/com/android/serv er/usage. Accessed Oct. 2021.   
[15] [15] UsageEvents.Event， https://developer.android.com/reference/androi d/app/usage/UsageEvents.Eve   
[16] [16] F.Ahmed. "Child Monitor." 2018.   
[17] [17] A. K. Singh, A.K. Prajapati, V. Kumar, S. Mishra, "Usage analy sis of mobile devices." Procedia computer science，Vol. 122,pp. 657-6 62, 2017.   
[18] A. Possemato, D. Nisi, Y. Fratantonio. "Preventing and Detecting Stat e Inference Attacks on Android." Network and Distributed Systems S ecurity （NDSS） Symposium 2021,2021.   
[19] Y. Konduru, N. Mishra, S.Sharma,"Acquisition and Analysis of Fore nsic Data Artefacts of Some Popular Apps in Android Smartphone.", 2018 IEEE 16th Intl Conf on Dependable,Autonomic and Seeure Com puting，16th Intl Conf on Pervasive Intelligence and Computing， 4th I ntl Conf on Big Data Intelligence and Computing and Cyber Science and Technology Congress(DASC/PiCom/DataCom/CyberSciTech)， pp. 86-93,2018.   
[20] H. Pieterse,M. Olivier, R.V. Heerden， "Smartphone data evaluation m odel: Identifying authentic smartphone data." Digital Investigation， Vo 1. 24,pp. 11-24，2018.   
[21] A. Brignoni, Usagestats XML Parser, https://abrignoni.blogspot.com/2 019/02/android-UsageStats-xml-parser.html. Accessed Oct, 2021.   
[22] Y. Khatri, UsageStats on Android 10(Q)， https://www.swiftforensics.c om/search?q $=$ usagestat. Accessed Oct， 2021.   
[23] Identifying the Android Operating System Version thru UsageStats, https://sansorg.egnyte.com/dl/7fcm4X4GtN. Accessed Oct, 2021.   
[24] AOSP proto files,https://github.com/aosp-mirror/platform_frameworks _base/tree/master/core/proto/android/server/usagestatsservice.proto. Ac cessed Oct， 2021.   
[25] protoc，https://github.com/protocolbuffers/protobuf/releases.Accessed Oct，2021.   
[26] AOSP proto files, https://github.com/aosp-mirror/platform_frameworks _base/tree/master/core/proto. Accessed Oct, 2021.
