# 비루팅 환경에서 ADB 로그를 활용한 스마트폰 촬영 행위 탐지 및 타임라인 복원에 관한 연구

## 1. 서론
### 1.1 연구 배경 및 문제 제기
- 1.1.1 스마트폰 촬영으로 인한 정보 유출 위협
- 1.1.2 보안 현장에서의 촬영 행위 사후 탐지 필요성
- 1.1.3 현행 보안 방법의 한계점 분석
  - 물리적 보안 (카메라 필름)의 우회 가능성
  - MDM 솔루션의 프라이버시 침해 및 법적 제약
  - 포렌식 도구의 루팅 요구사항 및 현장 적용 어려움

### 1.2 연구 목적 및 연구 문제
- 1.2.1 연구 목적: 비루팅 환경에서 실무 활용 가능한 촬영 탐지 및 타임라인 복원 시스템 개발
- 1.2.2 핵심 연구 질문
  - RQ1: ADB dumpsys 로그에서 촬영 행위를 구분할 수 있는 신뢰성 있는 신호가 존재하는가?
  - RQ2: 다중 로그 조합을 통해 단일 로그 대비 탐지 성능을 향상시킬 수 있는가?
  - RQ3: 개발된 타임라인 복원 모듈이 실무 환경에서 활용 가능한 수준의 정확도와 사용성을 제공하는가?

### 1.3 연구 의의 및 차별성
- 1.3.1 학술적 의의: 비루팅 환경 다중 로그 분석 방법론 제시
- 1.3.2 실무적 가치: 현장 적용 가능한 프로토타입 개발

## 2. 이론적 배경 및 선행 연구
### 2.1 안드로이드 시스템 로그 구조
- 2.1.1 ADB(Android Debug Bridge) 및 dumpsys 시스템
- 2.1.2 비루팅 환경에서의 로그 접근 범위와 제약사항
- 2.1.3 카메라 관련 시스템 서비스 구조

### 2.2 기존 촬영 탐지 방법론 및 한계
- 2.2.1 물리적 보안: 탈부착 용이성, 위조 가능성
- 2.2.2 MDM 솔루션: 프라이버시 침해, 관리 부담
- 2.2.3 포렌식 도구: 루팅 요구, 고비용, 즉시성 부족

### 2.3 선행 연구 분석
- 2.3.1 루팅 기반 로그 분석 연구의 실무 적용 한계
- 2.3.2 비루팅 환경 연구의 정성적 분석 한계
- 2.3.3 파일 시스템 기반 연구의 삭제 취약성

### 2.4 연구 차별성
- 2.4.1 다원 로그 조합을 통한 탐지 정확도 향상
- 2.4.2 정량적 성능 평가 및 실무 활용성 검증
- 2.4.3 프로토타입 구현을 통한 실용성 입증

## 3. 예비 실험 및 핵심 로그 발견
### 3.1 예비 실험의 목적 및 필요성
- 3.1.1 기본 가정 검증: ADB 로그에서 촬영 관련 정보 존재 여부
- 3.1.2 탐색적 연구: 어떤 로그가 촬영 행위를 반영하는가?
- 3.1.3 방법론 개발 기반: 본실험 설계를 위한 핵심 정보 도출

### 3.2 예비 실험 수행 및 결과
- 3.2.1 실험 환경: Galaxy S24 Ultra, Android 15
- 3.2.2 기본 촬영 시나리오 수행
- 3.2.3 ADB dumpsys 로그 수집 및 초기 분석

### 3.3 핵심 로그 발견 및 분석
- 3.3.1 새로운 파일 생성 로그 발견
  - media.camera.worker.txt의 INSERT content://secmedia/media 로그
  - 파일 생성 시점의 정확한 타임스탬프 (2025-08-20 10:37:24.191)
- 3.3.2 촬영 행위 직접 신호 발견  
  - vibrator_manager.txt의 셔터 진동 로그 (10:37:23.702)
  - com.sec.android.app.camera 패키지 식별
- 3.3.3 세션 관리 로그 확인
  - power.txt의 NotificationManagerService 로그
  - usagestats.txt의 FOREGROUND_SERVICE_START 로그

### 3.4 역할군 기반 로그 분류 체계 도출
- 3.4.1 R1 (세션 신호): 카메라 앱 실행 및 종료 관련 로그
- 3.4.2 R2 (촬영 신호): 실제 촬영 행위를 직접 반영하는 로그  
- 3.4.3 R3 (파일 신호): 촬영 결과물의 생성 및 저장 관련 로그

### 3.5 시간적 상관관계 및 탐지 가능성 관찰
- 3.5.1 촬영 시점과 로그 발생의 시간적 패턴 (1.2초 지연 확인)
- 3.5.2 비촬영 상황과의 명확한 차이점 확인
- 3.5.3 선행 연구에서 놓친 핵심 로그 식별

## 4. 본 실험 설계 및 데이터 수집
### 4.1 본 실험 설계
- 4.1.1 예비 실험 결과 기반 실험 계획
  - 핵심 로그 3개 그룹 (R1/R2/R3) 중심 분석
  - INSERT 로그를 Ground Truth로 활용
- 4.1.2 실험 대상 및 범위 (Android 15, 14, 13)
  - 주 실험: 기본 카메라 앱 
  - 비교 실험: 카카오톡 앱
  - 확장 실험: 텔레그램, 무음 앱 (필요시)
- 4.1.3 성능 평가 지표 정의
  - 정확성(A): F1-score 기반 촬영 탐지 성능
  - 시간 정확도: 실제 촬영 시점과의 오차 범위

### 4.2 데이터 수집 방법
- 4.2.1 로그 수집 절차
  - 표준화된 배치 스크립트 활용
  - 촬영 전후 1초 윈도우 내 로그 수집
- 4.2.2 Ground Truth 수집
  - content query 명령어를 통한 파일 생성 시점 확인
  - INSERT 로그와의 교차 검증
- 4.2.3 데이터 정제 및 전처리
  - 역할군별 로그 분류 및 태깅
  - 시간 정규화 (yyyy-MM-dd HH:mm:SS.sss)

### 4.3 실험 수행 결과
- 4.3.1 시나리오별 데이터 수집 현황
- 4.3.2 수집된 로그 데이터 개요 및 품질 평가
- 4.3.3 예비 실험 대비 추가 발견사항

## 5. 로그 분석 및 성능 평가
### 5.1 개별 로그 성능 분석
- 5.1.1 역할군별 로그 성능 측정
  - R1: 세션 관리 로그 정확도
  - R2: 촬영 신호 로그 정확도  
  - R3: 파일 생성 로그 정확도
- 5.1.2 시간 정확도 및 지연 패턴 분석
- 5.1.3 오탐/미탐 원인 분석

### 5.2 로그 특성 측정
- 5.2.1 정확성(A): F1-score 기반 촬영 탐지 성능
- 5.2.2 휘발성(P): 시간 경과 및 재부팅 후 로그 유지율
- 5.2.3 범용성(G): 안드로이드 버전별 성능 일관성

### 5.3 로그 조합 분석
- 5.3.1 역할군별 최적 로그 선별
- 5.3.2 로그 조합 성능 비교
  - 단일 로그 vs 2개 조합 vs 3개 조합
- 5.3.3 최종 로그 조합 결정 및 근거

## 6. 타임라인 복원 모듈 개발
### 6.1 모듈 설계 요구사항
- 6.1.1 기능적 요구사항: 시간순 촬영 행위 탐지 및 표시
- 6.1.2 비기능적 요구사항: 처리 속도, 사용 편의성

### 6.2 타임라인 복원 알고리즘
- 6.2.1 로그 시간 동기화 및 정규화 방법
- 6.2.2 이벤트 시퀀스 재구성 알고리즘
- 6.2.3 신뢰도 점수 계산 및 의심 구간 식별

### 6.3 프로토타입 구현
- 6.3.1 시스템 아키텍처
- 6.3.2 핵심 기능 구현
- 6.3.3 사용자 인터페이스 (개념 검증 수준)

## 7. 모듈 성능 평가 및 검증
### 7.1 탐지 성능 평가
- 7.1.1 최종 조합의 정확도, 정밀도, 재현율
- 7.1.2 시간 정확도 및 오차 범위 분석
- 7.1.3 앱별/버전별 성능 비교

### 7.2 실무 활용성 평가
- 7.2.1 타임라인 가독성 및 이해도
- 7.2.2 처리 속도 및 실시간성 평가
- 7.2.3 운영 편의성 및 확장성

### 7.3 기존 방법과의 비교 분석
- 7.3.1 포렌식 도구 대비 장단점
- 7.3.2 MDM 솔루션 대비 장단점
- 7.3.3 실무 도입 가능성 평가

## 8. 결론 및 향후 연구
### 8.1 연구 결과 요약 및 기여점
### 8.2 연구의 한계점 및 제약사항
### 8.3 향후 연구 방향
- 8.3.1 추가 앱 확장 연구
- 8.3.2 실시간 탐지 시스템 발전 방향
### 8.4 실무 적용 방안 및 정책 제언

---

## 부록
### A. 실험 환경 및 수집 로그 상세 정보
### B. 로그 샘플 및 파싱 결과