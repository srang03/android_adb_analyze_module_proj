

### **제2장. 이론적 배경 및 선행 연구**

#### **2.1. Android 로깅 시스템과 포렌식적 접근**

Android 운영체제는 시스템의 동작과 애플리케이션의 활동을 추적하기 위해 다층화된 로깅 시스템을 제공한다. 이 시스템은 디지털 포렌식 관점에서 비침해적 데이터 수집의 중요한 원천이 된다.

디지털 포렌식에서 증거 수집의 핵심 원칙은 **무결성(Integrity), 연속성(Chain of Custody), 그리고 비침해성(Non-intrusiveness)**이다. 무결성은 수집된 데이터가 원본과 동일함을 보장하는 것이며, 연속성은 증거의 수집부터 분석까지 전 과정이 적절히 문서화되고 관리됨을 의미한다. 비침해성은 증거 수집 과정에서 원본 시스템에 변화를 주지 않음을 의미하는데, 특히 모바일 기기의 경우 루팅과 같은 침해적 접근은 기기의 보증을 무효화하고 새로운 보안 취약점을 야기할 수 있어 비침해적 접근의 중요성이 더욱 강조된다 (박은후, 2020). 시스템 로그는 이러한 디지털 포렌식의 기본 원칙을 충족하면서도, 사용자 행위의 시간적 순서와 맥락을 복원할 수 있는 중요한 증거 소스로 평가된다.

본 절에서는 본 연구와 관련된 핵심 개념인 Android 로깅 시스템의 구조와 데이터 접근 방법론을 기술한다.

**2.1.1. Android 로깅 시스템의 계층적 구조**

Android의 로깅 시스템은 크게 **커널(Kernel), 프레임워크(Framework), 애플리케이션(Application)**의 3개 계층에서 발생하는 이벤트를 기록한다.

*   **커널 레벨 로그:** 리눅스 커널에서 직접 관리하며, 하드웨어 드라이버와의 상호작용 등 저수준 시스템 활동을 포함한다. 카메라 하드웨어 활성화, 센서 제어, 햅틱 피드백 등 물리적 하드웨어 접근과 관련된 이벤트가 여기에 기록된다.
*   **프레임워크 레벨 로그:** Android 시스템 서비스를 통해 발생하는 이벤트를 기록한다. Activity Manager, Window Manager, Media Service, Audio Service 등 핵심 프레임워크의 상태 변화가 여기에 해당하며, `dumpsys` 명령어의 주된 분석 대상이다. **카메라 관련 행위 탐지 관점에서**, 이 계층의 로그들은 **서로 다른 탐지 영역에 특화된 특성**을 보인다: `media.camera` 서비스는 카메라 하드웨어 접근과 세션 관리를 담당하여 **앱의 카메라 사용 행위** 탐지에 특화되며, `audio` 서비스는 셔터음, 오디오 포커스 변화 등을 통해 **실제 촬영 순간** 탐지에 특화된다. `activity` 서비스는 앱 생명주기 및 Intent 통신을 관리하여 **앱 실행 맥락** 분석에 유용하다.
*   **애플리케이션 레벨 로그:** 개별 애플리케이션이 생성하는 로그로, 앱의 생명주기, 사용자 상호작용, 오류 보고 등을 포함한다. `UsageStats` 서비스가 대표적인 예로, 애플리케이션의 사용 패턴과 시간 정보를 종합적으로 수집하고 장기간 보존하는 특성을 가진다.

**2.1.2. ADB(Android Debug Bridge)를 이용한 비루팅 데이터 접근**

본 연구의 핵심 전제인 '비루팅 환경'에서 시스템 로그에 접근하는 표준적인 방법은 ADB를 활용하는 것이다. ADB는 개발자 디버깅을 위해 설계되었으나, 포렌식 분석에서도 `shell` 명령어를 통해 기기의 내부 상태를 확인할 수 있는 강력한 인터페이스를 제공한다. 특히 `dumpsys` 명령어는 각 시스템 서비스가 메모리에 보관 중인 상태 정보와 이벤트 버퍼를 출력해주어, 루팅 없이도 다양한 아티팩트를 수집할 수 있게 한다.

다만, ADB 접근법에는 몇 가지 실무적 제약사항이 존재한다. 먼저 USB 디버깅 모드가 사전에 활성화되어 있어야 하며, 사용자의 인증 과정(ADB 키 승인)이 필요하다. 또한 일부 제조사는 독자적인 보안 정책을 통해 특정 시스템 정보에 대한 접근을 제한할 수 있으며, OEM 잠금 상태나 MDM 정책이 적용된 기기에서는 일부 `dumpsys` 서비스의 출력이 제한될 수 있다.

```bash
# 예시: 주요 시스템 서비스와 dumpsys 명령어
adb shell dumpsys activity            # ActivityManager - 앱 실행 상태 및 생명주기
adb shell dumpsys window              # WindowManager - 화면 및 윈도우 관리
adb shell dumpsys usagestats          # UsageStats - 앱 사용 패턴 및 통계
adb shell dumpsys audio               # AudioService - 오디오 시스템 상태
adb shell dumpsys media.camera        # CameraService - 카메라 하드웨어 상태
adb shell dumpsys wifi                # WifiManager - Wi-Fi 연결 상태
```

**2.1.3. 로그 데이터의 특성과 휘발성**

Android 시스템 로그의 가장 중요한 특성 중 하나는 **휘발성(Volatility)**이다. 대부분의 시스템 로그는 디스크가 아닌 **메모리 버퍼 방식**으로 저장되며, 이는 시스템 성능 최적화를 위해 설계된 것이다. **순환 버퍼(Circular Buffer)** 방식을 사용하는 `logcat`이나 대부분의 `dumpsys` 서비스는 정해진 버퍼 크기를 초과하면 오래된 데이터부터 자동으로 덮어쓴다(박은후, 2020).

로그 휘발성을 유발하는 주요 요인으로는 **재부팅(Rebooting), 시간 경과(Time Passage), 사용량 누적(Usage Accumulation)**이 있다. 재부팅 시 대부분의 메모리 버퍼가 초기화되며, 시간이 경과할수록 신규 이벤트에 의해 이전 로그가 밀려난다. 또한 사용자의 다양한 활동(앱 실행, 미디어 재생 등)이 증가할수록 로그 버퍼가 더 빠르게 오버플로우된다.

따라서 포렌식 관점에서 로그는 **지속성 로그(Persistent Logs)**와 **휘발성 로그(Volatile Logs)**로 구분된다. `UsageStats`와 같은 사용 통계 서비스는 비교적 오랜 데이터를 유지하는 특성으로 지속성이 높으며, 미디어 처리나 하드웨어 제어와 관련된 실시간 이벤트 로그들은 상대적으로 휘발성이 높다. 이러한 **로그 유형별 특성 차이**는 시간 경과, 사용량 누적, 시스템 재시작 등의 휘발성 요인이 각기 다른 영향을 미치는 이론적 근거가 되며, 포렌식 분석에서 수집 시점과 조건에 따른 증거 가용성을 예측하는 데 중요한 기반이 된다.

**2.1.4. 카메라 행위의 이중 탐지 이론적 배경**

Android 시스템에서 카메라 관련 행위는 **카메라 서비스 접근 단계**와 **실제 미디어 생성 단계**라는 **두 개의 구별되는 프로세스**로 나뉜다. 이는 Android 아키텍처의 계층적 설계와 보안 정책에 기인한다.

**카메라 서비스 접근 단계 (Camera Service Access Phase)**:
- **프로세스**: 앱이 `CameraManager.openCamera()` 호출을 통해 카메라 하드웨어에 대한 접근 권한을 요청하고 `CameraCaptureSession`을 생성하는 단계
- **시스템 반응**: `media.camera` 서비스에서 클라이언트 연결, 권한 확인, 세션 생성 등의 이벤트 기록
- **특성**: 카메라 앱이 실행되어 하드웨어 제어권을 얻는 순간부터 기록되며, **실제 촬영 여부와 무관하게** 발생
- **관련 로그**: `media.camera`, `activity`, `usagestats` 등 서비스 접근 및 앱 사용 패턴 관련 로그

**실제 미디어 생성 단계 (Media Creation Phase)**:
- **프로세스**: 사용자가 촬영 버튼을 클릭하여 실제 이미지 캡처 및 파일 생성이 수행되는 단계
- **시스템 반응**: 셔터음 재생, 햅틱 피드백, 미디어 파일 생성, MediaStore 등록 등의 이벤트 기록
- **특성**: 카메라 사용 중에서도 **실제 촬영 행위가 발생한 특정 시점**에만 기록
- **관련 로그**: `audio`, `media.metrics`, `vibrator_manager` 등 촬영 행위 직접 증거 로그

이러한 **이중 프로세스 구조**는 각 시스템 로그가 카메라 관련 행위의 **서로 다른 측면**에 특화된 정보를 제공할 수 있는 **이론적 근거**가 된다. 따라서 동일한 로그 데이터를 서로 다른 **두 가지 분석 목표**로 평가함으로써 각 로그의 **특화된 탐지 영역**을 정량적으로 규명할 수 있다.

#### **2.2. 선행 연구 검토**

본 절에서는 기존 연구들이 Android 시스템 로그를 포렌식적으로 어떻게 활용했으며, 특히 카메라 행위 탐지와 관련하여 어떤 성과와 한계를 보였는지를 비판적으로 검토한다.

**2.2.1. Android 시스템 로그의 포렌식적 활용 연구**

다수의 선행 연구가 Android 시스템 로그의 포렌식적 가치를 입증해왔다. **권혁철(2024)**은 `dumpsys`와 `logcat`으로 수집 가능한 방대한 진단 로그를 '사용자 행위', '사용자 데이터' 등으로 체계적으로 분류하고 정규화하는 방안을 제시하여, 복잡한 로그 데이터의 분석 기반을 마련하였다. **강예지 외(2021)**는 `UsageStats` 서비스에 대한 심층 분석을 통해, OS 버전에 따른 구조 변화를 규명하고 앱 실행, 화면 잠금 해제 등 구체적인 사용자 행위를 재구성하는 방법론을 제시하였다. 

**박은후(2020)**는 비루팅 환경에서 버그 리포트를 활용한 비휘발성 로그 분석 프로세스를 제안하였으며, 사용자 행위의 시간적 순서 복원 가능성을 실증하였다. **조재형(2016)**은 시스템 로그를 통한 공장초기화와 USIM 교체 등의 안티 포렌식 행위 탐지 방법론을 제시하여, 악의적 증거 은폐 시도를 식별하는 기술적 토대를 마련하였다. 이러한 연구들은 시스템 로그가 파일 시스템 아티팩트를 보완하는 중요한 증거 소스임을 명확히 보여주었다.

**2.2.2. 카메라 행위 탐지 관련 선행 연구**

카메라 행위 탐지에 초점을 맞춘 연구들도 일부 존재한다. **안원석 외(2025)**는 기본 카메라 앱(직접 API 호출)과 메신저 앱(인텐트 위임)이 `media.camera` 서비스 접근에서 서로 다른 패턴을 보임을 실증하였으며, `audio` 서비스 로그와 함께 분석하여 재부팅 전 환경에서 촬영/녹음 행위의 흔적을 식별할 수 있음을 정성적으로 확인하였다. **김승규 외(2020)**는 `logcat` 로그를 실시간으로 분석하여 불법 촬영 범죄에 대응하는 현장용 도구를 제안하였다.

해외 선행연구로는 **Bortnik & Lavrenovs (2019)**가 NATO Cooperative Cyber Defence Centre에서 수행한 연구가 주목할 만하다. 이들은 차량 사고 조사 시 운전자의 모바일 기기 상호작용을 탐지하기 위해 8개의 핵심 `dumpsys` 서비스(activity, usagestats, wifi, bluetooth_manager, telecom, mount, statusbar, customfrequencymanagerservice)를 체계적으로 분석하였다. 특히 이들의 연구는 루트 권한 없이 사용자 수준 접근만으로도 로그인 활동, 화면 활동, 통화 활동 등의 사용자 행위를 신뢰성 있게 탐지할 수 있음을 실증하였다. 또한 **Grover (2013)**는 MITRE Corporation에서 기업용 Android 모니터링 시스템을 개발하여, 비루팅 환경에서 15개 데이터셋을 자동으로 수집하는 방법론을 제시하였으며, 이는 실시간 연속 모니터링의 기술적 기반을 마련하였다.

**2.2.3. 선행 연구의 공통된 한계와 연구 공백**

상기 선행 연구들은 Android 시스템 로그의 포렌식적 가치를 밝히는 데 중요한 기여를 하였으나, 다음과 같은 명확하고 공통적인 한계를 가진다.

1.  **정성적 분석의 한계:** 대부분의 연구가 특정 로그에서 행위의 흔적을 '발견할 수 있다'는 **정성적(Qualitative) 가능성**을 제시하는 데 그쳤다.
2.  **단순 탐지 접근의 한계:** 기존 연구들은 카메라 관련 행위를 단순히 "발생함/안함"으로만 접근했으며, **2.1.4에서 제시한 이중 프로세스 구조**를 고려하지 않아 **카메라 서비스 접근**과 **실제 미디어 생성**을 구분하지 못했다. 이로 인해 각 로그의 **특화된 탐지 영역**을 규명하지 못하고 실무에서 "언제 어떤 로그를 우선 확인해야 하는가"에 대한 가이드라인을 제공하지 못했다.
3.  **정량적 성능 평가 부재:** 제안된 방법이 실제 시나리오에서 **얼마나 정확하게(Accuracy), 얼마나 빠짐없이(Recall) 행위를 탐지하는지**에 대한 정량적 성능 지표가 부재하다.
4.  **체계적 검증 부족:** 다양한 변수(예: 앱 구현 방식)가 탐지 성능에 미치는 영향을 통제된 실험을 통해 과학적으로 검증한 연구는 전무하다.
5.  **실무적 한계 미고려:** 로그의 휘발성(재부팅, 시간 경과)이라는 실무적 제약 조건이 탐지율에 미치는 영향을 정량적으로 분석한 연구가 없다.

이러한 **'정량적 성능 및 한계 규명의 부재'**는 1장에서 제기한 본 연구의 핵심적인 연구 공백(Research Gap)이다.

#### **2.3. 본 연구의 차별성 및 학술적 위치**

본 연구는 선행 연구들이 마련한 정성적 분석의 토대 위에서, **'정량적 검증'**이라는 다음 단계로 나아간다. 선행 연구들이 "무엇(What)을 찾을 수 있는가"에 집중했다면, 본 연구는 "**얼마나(How much)** 잘 찾을 수 있으며, 그 **한계(Limitation)**는 무엇인가"라는 질문에 답하고자 한다.

이를 위해 본 연구는 다음과 같은 차별성을 가진다.

*   **방법론적 차별성:** 개별 로그의 단편적 분석을 넘어, **2.1.4에서 제시한 이론적 배경**을 바탕으로 개발한 **이중 분석 프레임워크**를 통해 각 로그의 **카메라 사용 탐지**와 **카메라 촬영 탐지**를 분리 측정하며, 그 결과를 **192세션(파일럿 테스트 32세션 + 본 실험 160세션)의 대규모 통제 실험**을 통해 과학적으로 검증한다.
*   **실무적 차별성:** Android Developer Documentation의 공식 2가지 카메라 구현 방식을 포렌식 관점에서 **4가지 앱 아키텍처 유형(S1-S4)**으로 세분화한 연구 목적에 맞는 분류 체계와 **'로그 휘발성'**이라는 핵심적인 실무 변수가 각 로그의 **특화된 탐지 성능**에 미치는 영향을 통계적으로 분석하고, **효율적 실험 전략**(V0-V-Time 연계, V-Usage 연속성으로 35% 시간 단축)을 통해 현장 분석가에게 "언제 어떤 로그를 우선 확인해야 하는가"에 대한 과학적 가이드라인을 제공한다.
*   **기술적 시의성(Timeliness):** 본 연구는 최신 운영체제인 Android 15를 분석 대상으로 하여, 기존 연구 결과의 유효성을 검증하고 변화된 로그 환경에서의 새로운 탐지 가능성을 탐색하는 최초의 연구 중 하나이다. 이는 빠르게 진화하는 안드로이드 생태계에 대한 포렌식 지식의 연속성을 확보하고, 향후 최신 기기에 대한 분석 방법론의 기틀을 마련한다는 점에서 중요한 학술적 기여를 한다.

따라서 본 연구는 선행 연구들이 제시한 정성적 발견들을 토대로, **정량적 성능 평가와 체계적 한계 규명**이라는 다음 단계의 학술적 기여를 수행하고자 한다. 구체적으로는 다음 세 가지 핵심 차별성을 통해 기존 연구 공백을 해결한다.

첫째, **로그별 성능 특성의 체계적 규명**이다. 기존 연구들이 카메라 관련 행위를 정성적으로만 접근한 반면, 본 연구는 각 시스템 로그가 **탐지 분석 유형별**로 보이는 개별적인 성능과 한계를 정량적으로 측정한다. 이를 통해 실무 현장에서 요구되는 로그별 활용 가이드라인을 과학적으로 뒷받침한다.

둘째, **정량적 성능 측정을 통한 과학적 검증**이다. 선행 연구들이 정성적 가능성 제시에 그친 반면, 본 연구는 선별된 시스템 로그들의 개별적인 탐지 성능을 정확도, 정밀도, 재현율, F1-Score 등의 정량적 지표로 측정하여, 기존 연구의 정성적 접근 한계를 극복한다.

셋째, **실무적 한계 규명을 통한 적용 가능성 제시**이다. **192세션(파일럿 테스트 32세션 + 본 실험 160세션)의 대규모 통제 실험**을 통해 **4가지 앱 아키텍처 유형(S1-S4)** 차이와 로그 휘발성(재부팅, 시간 경과, 사용량 누적)이 각 로그의 **탐지 분석 유형별 성능**에 미치는 영향을 정량적으로 분석하여, 각 로그의 **특화된 탐지 영역**과 실무 적용 가능 범위, 명확한 사각지대를 실증적으로 규명한다. 이는 기존 연구의 정성적 가능성 제시를 넘어, **이중 분석 프레임워크**를 통한 실무 도입을 위한 객관적 판단 근거를 최초로 제공하는 의미를 갖는다.
